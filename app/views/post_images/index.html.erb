
<!--<body class="background">-->

  <!--<%# @post_images.each do |post_image| %>-->
  <!--<div>-->
  <!--  <%#= attachment_image_tag post_image, :image %>-->
  <!--  <p>タイトル：<%#=link_to post_image_path(post_image.id) do %><%#= post_image.title %><%# end %></p>-->
  <!--  <p>説明：<%#= post_image.introduction %></p>-->
  <!--  <p>投稿者：<%#= post_image.user %></p>-->
  <!--  <p>投稿日時：<%#= post_image.created_at.strftime('%Y/%m/%d') %></p>-->

  <!--</div>-->
  <!--<%# end %>-->
<br>
<html>
 <body class="background">
   <div class="container">
    <div class="row">
      <h4>地図</h4>
    </div>
        <div id='map'></div>

        <style>
        #map {
          height: 600px;
          width: 70%;
        }
        </style>

        <!-- js部分 -->
        <script>
            function initMap() {

              //初期表示位置
              let latlng = new google.maps.LatLng(38.60, 139.5);
              //デザイン
              let styles = [
                   {
                    stylers: [
                     { "saturation": 0 },
                     { "lightness": 0 }
                    ]
                   }
                  ];

              let map = new google.maps.Map(document.getElementById('map'), {
                  zoom: 6,
                  styles: styles,
                  center: latlng
              });
              let transitLayer = new google.maps.TransitLayer();
              transitLayer.setMap(map);

              //複数マーカー ここから
              <% @post_images.each do |post|%>
                ( function() {
                  let markerLatLng = new google.maps.LatLng({lat: <%= post.latitude %>, lng: <%= post.longitude %>}); // 緯度経度のデータ作成
                  let marker = new google.maps.Marker({
                    position: markerLatLng,
                    map: map
                  });
                //マーカーをクリックしたとき、詳細情報を表示
                  let infowindow = new google.maps.InfoWindow({
                    position: markerLatLng,
                    content: "<a href='<%= post_image_url(post.id) %>' target='_blank'><%= post.title %></a>"
                  }); //ここで詳細ページへのリンクを表示させる
                  marker.addListener('click', function() {
                    infowindow.open(map, marker);
                  });

               })();
              <% end %>
              // 複数マーカー ここまで
          }
        </script>
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC_tiqnCsg_w_qy1zBf2AC5C-sWLBcuN50&callback=initMap" async defer></script>

   </div>
  </body>
</html>